# Generated by Chef
set daemon <%= @poll_freq %>
  with start delay <%= @start_delay %>
set logfile <%= @log_file %>
set idfile <%= @id_file %>
set statefile <%= @state_file %>
set mailserver
<% @mail_servers.each do |mailserver| %>
  <%= mailserver.hostname %> port <%= mailserver.port %>
  <% if mailserver.username %>
  username '<%= mailserver.username %>'
  <% end %>
  <% if mailserver.password %>
  password '<%= mailserver.password %>'
  <% end %>
  <% if mailserver.security %>
  using <%= mailserver.security %>
  <% end %>
  with timeout <%= mailserver.timeout %>
<% end %>
set mail-format {
      from: <%= @mail_from %>
   subject: <%= @mail_subject %>
   message: <%= @mail_msg %>
}
<% @subscribers.each do |subscriber| %>
set alert <%= subscriber.name %> 
  only on { <%= subscriber.subscriptions.join(', ') %>}
<% end %>
set eventqueue
  basedir <%= @eventqueue_dir %>
  slots <%= @eventqueue_slots %>
set httpd port <%= @port %> and
  use address <%= @listen %>
  <% @allow.each do |allowed| %>
  allow <%= allowed %>
  <% end %>
<% if @mmonit_url %>
set mmonit <%= @mmonit_url %>
<% end %>
include <%= @conf_dir %>/*
